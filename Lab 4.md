# Lab 4

Neste laboratório, veremos rapidamente o protocolo de transporte UDP. Como visto, o UDP é um protocolo simplificado e sem frescuras. Portanto, poderemos abordá-lo rapidamente neste laboratório. Nesta fase, você deve ser um especialista em Wireshark. Assim, não vamos explicar as etapas tão explicitamente quanto nos laboratórios anteriores.

Comece a capturar pacotes no Wireshark e faça algo que fará com que seu host envie e receba vários pacotes UDP. Também é provável que apenas não fazendo nada (exceto capturar pacotes via Wireshark) alguns pacotes UDP enviados por outros apareçam em seu rastreamento. Em particular, o protocolo Domain Name System (DNS) normalmente envia mensagens de consulta e resposta de DNS dentro do UDP, portanto, é provável que você encontre algumas mensagens de DNS (e, portanto, pacotes UDP) em seu rastreamento.

Especificamente, você pode experimentar o comando `nslookup`, que invoca o protocolo DNS subjacente, que por sua vez enviará segmentos UDP de/para o host que emite o `nslookup`. O `nslookup` está disponível na maioria dos sistemas operacionais Microsoft, Apple IOS e Linux. Para executar o `nslookup`, basta digitar o comando `nslookup` na linha de comando em uma janela do DOS, janela de terminal Mac IOS ou shell do Linux. A Figura 1 é uma captura de tela da execução do `nslookup` na linha de comando do Linux no host newworld.cs.umass.edu localizado no Departamento de CS do campus da Universidade de Massachusetts (UMass), para exibir o endereço IP de www.nyu.edu. Não precisamos entrar em mais detalhes sobre `nslookup` ou DNS, pois estamos apenas interessados em colocar alguns segmentos UDP no Wireshark.

![Figura 1: Um resultado básico do comando `nslookup`](nslookup-udp.png)

Depois de iniciar a captura de pacotes no Wireshark, execute `nslookup` para um nome de host que você não visita há algum tempo. Em seguida, pare a captura de pacotes, defina o filtro de pacotes do Wireshark para que o Wireshark exiba apenas os segmentos UDP enviados e recebidos em seu host. Escolha o primeiro segmento UDP e expanda os campos UDP na janela de detalhes. Se você não conseguir encontrar segmentos UDP em seu rastreamento ou não conseguir executar o Wireshark em uma conexão de rede ativa, você pode baixar um rastreamento[^1] de pacote contendo alguns segmentos UDP. Em seguida, responda as seguintes questões:

[^1]: Você pode baixar o arquivo zip <http://www-net.cs.umass.edu/wireshark-labs/wireshark-traces-8.1.zip> e extrair o arquivo de rastreamento dns-wireshark-trace1-1. Este arquivo de rastreamento pode ser usado para responder a este laboratório do Wireshark sem realmente capturar pacotes por conta própria. Este rastreamento foi feito utilizando o Wireshark rodando em um dos computadores do autor, enquanto realizava os passos indicados neste laboratório do Wireshark. Depois de baixar um arquivo de rastreamento, você pode carregá-lo no Wireshark e visualizar o rastreamento usando o menu suspenso Arquivo, escolhendo Abrir e selecionando o nome do arquivo de rastreamento.

1. Selecione o primeiro segmento UDP em seu rastreamento. Qual é o packet number[^2] deste segmento no arquivo de rastreamento? Que tipo de carga útil da camada de aplicação ou mensagem de protocolo está sendo transportada neste segmento UDP? Veja os detalhes deste pacote no Wireshark. Quantos campos existem no cabeçalho UDP? (Você não deve procurar no livro didático! Responda a essas perguntas diretamente do que você observa no rastreamento de pacotes.) Quais são os nomes desses campos?
2. Consultando as informações exibidas no campo de conteúdo do pacote do Wireshark para este pacote (ou consultando o livro), qual é o comprimento (em bytes) de cada um dos campos do cabeçalho UDP?
3. O valor no campo "Length" é o comprimento de quê? (Você pode consultar o texto para esta resposta). Verifique sua reivindicação com seu pacote UDP capturado.
4. Qual é o número máximo de bytes que podem ser incluídos em uma carga UDP? (Dica: a resposta a esta pergunta pode ser determinada pela sua resposta a questão 2 acima.)
5. Qual é o maior número de porta de origem possível? (Dica: veja a dica na questão 4.)
6. Qual é o número do protocolo para UDP? Para responder a essa pergunta, você precisará examinar o campo Protocolo do datagrama IP que contém esse segmento UDP (vide discussão dos campos de cabeçalho IP).
7. Examine o par de pacotes UDP em que seu host envia o primeiro pacote UDP e o segundo pacote UDP é uma resposta a este primeiro pacote UDP. (Dica: para que um segundo pacote seja enviado em resposta a um primeiro pacote, o remetente do primeiro pacote deve ser o destino do segundo pacote). Qual é o packet number do primeiro desses dois segmentos UDP no arquivo de rastreamento? Qual é o packet number do segundo desses dois segmentos UDP no arquivo de rastreamento? Descreva a relação entre os números de porta nos dois pacotes.

[^2]: Lembre-se de que este “número de pacote” é atribuído pelo Wireshark apenas para fins de listagem; NÃO é um número de pacote contido em qualquer cabeçalho de pacote real.
